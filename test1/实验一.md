# 实验一：分析SQL执行计划，执行SQL语句的优化指导

------------

## **教材中查询语句分析**
#### 查询1：
```sql
SELECT d.department_name,count(e.job_id)as "部门总人数",
avg(e.salary)as "平均工资"
from hr.departments d,hr.employees e
where d.department_id = e.department_id
and d.department_name in ('IT','Sales')
GROUP BY department_name;
```

------------
查询结果：
[![](https://github.com/tupengbox/oracle/blob/master/test1/test1_example1.1.png?raw=true)](www.github.com)

解释计划:

[![](https://github.com/tupengbox/oracle/blob/master/test1/test1_example1.2.png?raw=true)](www.github.com)

SQL优化查询结果：

[![](https://github.com/tupengbox/oracle/blob/master/test1/test1_example1.3.png?raw=true)](www.github.com)

详细信息：
[![](https://github.com/tupengbox/oracle/blob/master/test1/test1_example1.4.png?raw=true)](www.github.com)

------------

#### 查询2：
```sql
SELECT d.department_name，count(e.job_id)as "部门总人数"，
avg(e.salary)as "平均工资"
FROM hr.departments d，hr.employees e
WHERE d.department_id = e.department_id
GROUP BY department_name
HAVING d.department_name in ('IT'，'Sales');

```
------------
查询结果：
[![](https://github.com/tupengbox/oracle/blob/master/test1/test1_example2.1.png?raw=true)](www.github.com)

解释计划:
[![](https://github.com/tupengbox/oracle/blob/master/test1/test1_example2.2.png?raw=true)](www.github.com)

SQL优化查询结果：

[![](https://github.com/tupengbox/oracle/blob/master/test1/test1_example2.3.png?raw=true)](www.github.com)

详细信息：
[![](https://github.com/tupengbox/oracle/blob/master/test1/test1_example2.4.png?raw=true)](www.github.com)

------------
## 比较分析查询优劣：
		根据优化查询的指导，SQL查询语句一相比SQL查询语句二需要更多的索引维护的开销和附加的空间的消耗。查找结果的建议是通过创建一个或多个索引来改进此语句的执行计划，即在SQL语句的查询中需要通过创建相应的索引。原理：创建推荐的索引可以显著的改进此语句的的执行计划。但是，使用典型的SQL工作量运行“访问指导”可能比单个语句更可取。通过这种方法可以获得全面的索引，包括计算索引维护的开销和附加的空间消耗。